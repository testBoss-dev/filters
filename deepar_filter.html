<script>
  async function applyDeepARFilter(imageDataURL, filterName) {
    try {
      const canvas = document.getElementById("deepar-canvas");
      const deepAR = await deepar.initialize({
        licenseKey: "YOUR_LICENSE_KEY",
        canvas: canvas,
        rootPath: "https://cdn.deepar.ai/js/",
        effect: "https://firebasestorage.googleapis.com/v0/b/readicart-442b2.firebasestorage.app/o/deepar%20filters%2FNeon_Devil_Horns.deepar?alt=media&token=634e74ba-b27c-425a-9055-2b721406bb95"
      });

      // Map filter names to Firebase URLs
      const filterMap = {
        
        "hair": "https://firebasestorage.googleapis.com/v0/b/readicart-442b2.firebasestorage.app/o/deepar%20filters%2FNeon_Devil_Horns.deepar?alt=media&token=634e74ba-b27c-425a-9055-2b721406bb95",
        
      };

      const filterPath = filterMap[filterName] || filterMap["hair"];

      const img = new Image();
      const imageLoadPromise = new Promise(resolve => {
        img.onload = resolve;
      });
      img.src = imageDataURL;
      await imageLoadPromise;

      canvas.width = img.width;
      canvas.height = img.height;

      await deepAR.switchEffect(0, 'slot', filterPath);
      deepAR.processImage(img);

      await new Promise(r => setTimeout(r, 1000));

      const dataURL = canvas.toDataURL("image/png");
      await window.saveProcessedImage(dataURL);

      await deepAR.shutdown();

    } catch (error) {
      console.error("DeepAR JavaScript Error:", error);
    }
  }
</script>
